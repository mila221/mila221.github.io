<html>
	<head>
		<title>Deeplink</title>
	</head>
	<body>
		<h1>novoo 14</h1>
		<a style="font-size: 40px;" id="openAppLink" href="addiko://">Open/Download App</a>
		<img style="display:none;" src="qr.png" id="qrImage" width="400">
	</body>
	<script>
	document.addEventListener("DOMContentLoaded", function() {
	    var iOS = /iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream;
	    var android = /Android/.test(navigator.userAgent);
	    var huawei = /huawei|HONOR/.test(navigator.userAgent.toLowerCase()); // Note: This is a basic detection and might not be 100% accurate.
	
	    // Define the custom URI scheme for your app here.
	    var appURIios = "addiko://"; // replace 'myapp' with your app's custom URI scheme
	    var appURIandroid = "addiko:";

	    // Define URLs for your app in each app store.
	    var appleAppStoreURL = "https://apps.apple.com/app/id1135444312"; // replace 'YOUR_APP_ID' with your app's ID
	    var googlePlayStoreURL = "https://play.google.com/store/apps/details?id=com.addiko.mobile.serbia"; // replace 'YOUR_PACKAGE_NAME' with your app's package name
	    var huaweiStoreURL = "https://appgallery.huawei.com/app/C104332571"; // replace 'YOUR_APP_DETAILS' with the appropriate path or ID
	
	    // Attempt to open the app using the custom URI scheme.
	    // If the app isn't installed, this will fail and we'll catch that to redirect to the app store.
	    var link = document.getElementById("openAppLink");
	    var qrImage = document.getElementById("qrImage");
	    function isMobileDevice() {
		return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini|huawei|HONOR/i.test(navigator.userAgent);
	    }
		
	    if (isMobileDevice()) {
	        document.getElementById("openAppLink").addEventListener('click', function(e) {
		    e.preventDefault(); // Prevent default behavior
		
		    if (iOS) {
		        var hasAppOpened = false;
		
		        var clearEventsAndRedirectToStore = function() {
		            if (!hasAppOpened) {
		                document.removeEventListener('visibilitychange', handleVisibilityChange);
		                window.location = appleAppStoreURL;
		            }
		        };
		
		        var handleVisibilityChange = function() {
		            if (document.hidden) {
		                hasAppOpened = true;
		            }
		        };
		        document.addEventListener('visibilitychange', handleVisibilityChange);
		
		        window.location = appURIios; 
		
		        setTimeout(clearEventsAndRedirectToStore, 2000); // Adjust based on testing
		    } else if (android){
			var hasAppOpened = false;
		
		        var clearEventsAndRedirectToStore = function() {
		            if (!hasAppOpened) {
		                document.removeEventListener('visibilitychange', handleVisibilityChange);
		                window.location = googlePlayStoreURL;
		            }
		        };
		
		        var handleVisibilityChange = function() {
		            if (document.hidden) {
		                hasAppOpened = true;
		            }
		        };
		        document.addEventListener('visibilitychange', handleVisibilityChange);
		
		        window.location = appURIandroid; 
		
		        setTimeout(clearEventsAndRedirectToStore, 2000); // Adjust based on testing
		    }
		});
	    } else {
	        link.style.display = "none";
		qrImage.style.display = "block";
	    }	
	    
	    
	});

		
	</script>
</html>
